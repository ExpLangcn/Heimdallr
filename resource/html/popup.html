<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />

    <title>Heimdallr</title>

    <link rel="stylesheet" href="../css/element-plus@2.2.5/index.css" />
    <link rel="stylesheet" href="../css/html/popup.css" />

    <script src="../js/vue@3.2.36/vue.global.js"></script>
    <script src="../js/element-plus@2.2.5/index.full.js"></script>
    <script src="../js/element-plus@2.2.5/icons-vue@2.0.4/index.iife.min.js"></script>
</head>

<body>
    <div id="app">
        <el-container>
            <el-header>
                <div style="width: 100%;display: flex;">
                    <el-link href="https://github.com/graynjo/Heimdallr" target="_blank"><h1 style="font-family:'Courier New'">Heimdallr</h1></el-link>

                    <div style="display:inline-flex;align-items: center;justify-content: flex-end; flex-grow: 1;">
                        <el-tooltip class="box-item" effect="dark" content="暂停插件"  placement="bottom-end" v-if="pluginSwitch">
                            <el-button type="default" circle @click="changePlugin">
                                <el-icon style="vertical-align: middle;">
                                    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-78e17ca8=""><path fill="currentColor" d="M352 159.872V230.4a352 352 0 1 0 320 0v-70.528A416.128 416.128 0 0 1 512 960a416 416 0 0 1-160-800.128z"></path><path fill="currentColor" d="M512 64q32 0 32 32v320q0 32-32 32t-32-32V96q0-32 32-32z"></path></svg>
                                </el-icon>
                            </el-button>
                        </el-tooltip>
                        <el-tooltip class="box-item" effect="dark" content="启用插件"  placement="bottom-end" v-else>
                            <el-button type="default" circle  @click="changePlugin">
                                <el-icon style="vertical-align: middle;">
                                    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-78e17ca8=""><path fill="currentColor" d="M384 192v640l384-320.064z"></path></svg>
                                </el-icon>
                            </el-button>
                        </el-tooltip>
                        <el-tooltip class="box-item" effect="dark" content="清除所有缓存"  placement="bottom-end">
                            <el-button type="default" circle @click="removePopupResult">
                                <el-icon style="vertical-align: middle;">
                                    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-78e17ca8=""><path fill="currentColor" d="M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"></path></svg>
                                </el-icon>
                            </el-button>
                        </el-tooltip>
                        <el-tooltip class="box-item" effect="dark" content="设置"  placement="bottom-end">
                            <el-button type="default" circle @click="openSetting">
                                <el-icon style="vertical-align: middle;">
                                    <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-78e17ca8=""><path fill="currentColor" d="M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"></path></svg>                                </el-icon>
                            </el-button>
                        </el-tooltip>
                    </div>
                </div>
            </el-header>
            <el-main>
                <el-tabs type="border-card" v-model="tabPosition" stretch>

                    <!-- 指纹嗅探结果显示 -->
                    <el-tab-pane label="指纹嗅探" name="1">
                        <h2 class="plugin-header">嗅探结果</h2>
                        
                        <el-scrollbar height="320px">
                            <div v-if="printerLable !==undefined && printerLable != null  && printerLable.length > 0">
                                <!-- 绿色标签：指纹特征嗅探结果；灰色标签：关键词嗅探结果; 蓝色标签：主动扫描探测结果 -->
                                <span v-for="(item, index) in printerLable">
                                    <el-tag class="tag-block" hit type="success" v-if="item.sid === 1">{{item.scontent}}</el-tag>
                                    <el-tag class="tag-block" hit v-else-if="item.sid === 2">{{item.scontent}}</el-tag>
                                    <el-tag class="tag-block" hit type="info" v-else-if="item.sid === 3">{{item.scontent}}</el-tag>
                                </span>
                            </div>
                            <div v-else>
                                <el-empty description="暂无已识别指纹" />
                            </div>
                        </el-scrollbar>
                    </el-tab-pane>
                    

                    <!-- 蜜罐告警结果显示 -->
                    <el-tab-pane label="蜜罐告警" name="2">
                        <h2 class="plugin-header">蜜罐告警</h2>

                        <el-scrollbar height="320px">
                            <div v-if="honeypotLable !==undefined && honeypotLable != null  && honeypotLable.length > 0">
                                <!-- 红色标签：jsonp请求；橙色标签：js混淆等可疑特征 -->
                                <span v-for="(item, index) in honeypotLable">
                                    <el-tag class="tag-block" hit type="danger" v-if="item.sid === 4">{{item.scontent}}</el-tag>
                                    <el-tag class="tag-block" hit type="warning" v-else-if="item.sid === 5">{{item.scontent}}</el-tag>
                                </span>
                            </div>
                            <div v-else>
                                <el-empty description="暂未发现蜜罐特征" />

                            </div>
                        </el-scrollbar>
                    </el-tab-pane>



                    

                    <!-- 主动识别指纹控制栏 -->
                    <el-tab-pane label="策略配置" name="3">
                        <h2 class="plugin-header">嗅探策略配置</h2>
                        <el-scrollbar height="320px">
                            <h3 class="plugin-header">被动识别配置</h3>
                            <div style="width: 80%;display: flex;">
                                <span class="plugin-text" style="display:inline-flex;align-items: center; flex-grow: 1;">启用响应体规则匹配 </span>
                                <div style="display:inline-flex;align-items: center;justify-content: flex-end; flex-grow: 1;">
                                    <el-switch v-model="responseCheckSwitch" @change="responseCheckSwitchChange" class="mb-2" inline-prompt active-text="是" inactive-text="否" />
                                </div>
                            </div>
                            <div style="width: 80%;display: flex;">
                                <span class="plugin-text" style="display:inline-flex;align-items: center; flex-grow: 1;">启用关键词嗅探 </span>
                                <div style="display:inline-flex;align-items: center;justify-content: flex-end; flex-grow: 1;">
                                    <el-switch v-model="keyWordSniffSwitch" @change="keyWordSniffSwitchChange" class="mb-2" inline-prompt active-text="是" inactive-text="否" />
                                </div>
                            </div>
                            <div style="width: 80%;display: flex;">
                                <span class="plugin-text" style="display:inline-flex;align-items: center; flex-grow: 1;">关闭浏览器页面缓存（强制刷新） </span>
                                <div style="display:inline-flex;align-items: center;justify-content: flex-end; flex-grow: 1;">
                                    <el-switch v-model="noPageCacheSwitch" @change="noPageCacheSwitchChange" class="mb-2" inline-prompt active-text="是" inactive-text="否" />
                                </div>
                            </div>
                            <h3 class="plugin-header">蜜罐拦截配置</h3>
                            <div style="width: 80%;display: flex;">
                                <span class="plugin-text" style="display:inline-flex;align-items: center; flex-grow: 1;">符合蜜罐特征请求自动拦截 </span>
                                <div style="display:inline-flex;align-items: center;justify-content: flex-end; flex-grow: 1;">
                                    <el-switch v-model="blockHoneypotSwitch" @change="blockHoneypotSwitchChange" class="mb-2" inline-prompt active-text="是" inactive-text="否"  />
                                </div>
                            </div>
                            <div>
                                <h3 class="plugin-header">主动嗅探</h3>
                                <div style="display: flex;width: 80%;">
                                    <span class="plugin-text" style="display:inline-flex;align-items: center; flex-grow: 1;">对当前站点启用主动嗅探</span>
                                    <div style="display:inline-flex;align-items: center;justify-content: flex-end; flex-grow: 1;">
                                        <el-button v-if="activeScanning" disabled>
                                            <el-icon style="vertical-align: middle;">
                                                <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-78e17ca8=""><path fill="currentColor" d="M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"></path></svg>
                                            </el-icon>
                                        </el-button>
                                        <el-button v-else="activeScanning" disabled>
                                            <el-icon style="vertical-align: middle;">
                                                <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-78e17ca8=""><path fill="currentColor" d="M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"></path><path fill="currentColor" d="M512 96a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V128a32 32 0 0 1 32-32zm0 576a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V704a32 32 0 0 1 32-32zM96 512a32 32 0 0 1 32-32h192a32 32 0 0 1 0 64H128a32 32 0 0 1-32-32zm576 0a32 32 0 0 1 32-32h192a32 32 0 1 1 0 64H704a32 32 0 0 1-32-32z"></path></svg>                                                </el-icon>
                                        </el-button>
                                    </div>
                                </div>
                                <div v-if="activeScanning">
                                    <span class="plugin-text">主动识别进度：</span><br />
                                    <div class="demo-progress">
                                        <el-progress :text-inside="true" :stroke-width="18" :percentage="100" status="success" />    
                                    </div>
                                </div>
                            </div>
                        </el-scrollbar>
                    </el-tab-pane>


                    <!-- 相关UA等浏览器特征控制工具 -->
                    <el-tab-pane label="特征隐藏" name="4" disabled>
                        <h2 class="plugin-header">自定义浏览器特征</h2>
                        <el-scrollbar height="320px">
                            <el-form class="demo-form-inline" label-position="left" label-width="100px">
                                <el-form-item label="UA">
                                    <el-select  placeholder="UA Header">
                                    <el-option label="Zone one" value="shanghai" />
                                    <el-option label="Zone two" value="beijing" />
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="xff">
                                    <el-select  placeholder="UA Header">
                                        <el-option label="Zone one" value="shanghai" />
                                        <el-option label="Zone two" value="beijing" />
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="cookie">
                                    <el-select  placeholder="UA Header">
                                        <el-option label="Zone one" value="shanghai" />
                                        <el-option label="Zone two" value="beijing" />
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="随机机器码">
                                    <el-select  placeholder="UA Header">
                                        <el-option label="Zone one" value="shanghai" />
                                        <el-option label="Zone two" value="beijing" />
                                    </el-select>
                                </el-form-item>
                                <el-form-item>
                                    <el-button type="primary" @click="test()" >Query</el-button>
                                </el-form-item>
                            </el-form>
                            
                        
                        </el-scrollbar>
                    </el-tab-pane>

                </el-tabs>
            </el-main>
        </el-container>
    </div>

    <script src="../js/html/popup.js"></script>

</body>

</html>